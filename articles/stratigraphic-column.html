<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Plotting a stratigraphic column with rmacrostrat • rmacrostrat</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plotting a stratigraphic column with rmacrostrat">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rmacrostrat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/geologic-map.html">Making a geologic outcrop map with rmacrostrat</a></li>
    <li><a class="dropdown-item" href="../articles/geological-completeness.html">Quantifying the geological completeness of paleontological sampling in North America</a></li>
    <li><a class="dropdown-item" href="../articles/stratigraphic-column.html">Plotting a stratigraphic column with rmacrostrat</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/palaeoverse/rmacrostrat/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plotting a stratigraphic column with rmacrostrat</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/palaeoverse/rmacrostrat/blob/main/vignettes/stratigraphic-column.Rmd" class="external-link"><code>vignettes/stratigraphic-column.Rmd</code></a></small>
      <div class="d-none name"><code>stratigraphic-column.Rmd</code></div>
    </div>

    
    
<p><strong>Authors:</strong> <a href="https://palaeoverse.org/#about-us" class="external-link">Palaeoverse Development
Team</a></p>
<p><strong>Last updated:</strong> 2024-10-02</p>
<div style="text-align: justify">
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><code>rmacrostrat</code> is an R package which allows users to easily
retrieve geological data from the <a href="https://macrostrat.org" class="external-link">Macrostrat</a> database and facilitates
analyses of these data within the R environment. This vignette (or
tutorial, if you prefer) is provided to guide you through the
installation process and some of the functionality available within
<code>rmacrostrat</code>. Specifically, we will focus on obtaining and
plotting a geologic column, containing stratigraphic and lithological
information for the San Juan Basin, located in the southwestern United
States.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The <code>rmacrostrat</code> package can be installed via CRAN, or
its dedicated <a href="https://github.com/palaeoverse/rmacrostrat" class="external-link">GitHub repository</a>
if the development version is preferred. To install via CRAN, simply
use:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"rmacrostrat"</span><span class="op">)</span></span></code></pre></div>
<p>To install the development version, first install the
<code>devtools</code> package, and then use <code>install_github</code>
to install <code>rmacrostrat</code> directly from GitHub.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"palaeoverse/rmacrostrat"</span><span class="op">)</span></span></code></pre></div>
<p>You can now load <code>rmacrostrat</code> using the default
<code>library</code> function, alongside some packages we will need for
plotting, namely <code>ggplot2</code>, <code>ggrepel</code>, and
<code>deeptime</code> (don’t forget to install these packages if you
don’t have them already!):</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rmacrostrat.palaeoverse.org">rmacrostrat</a></span><span class="op">)</span></span>
<span><span class="co"># Install and load data visualization packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggrepel.slowkow.com/" class="external-link">ggrepel</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://williamgearty.com/deeptime/" class="external-link">deeptime</a></span><span class="op">)</span></span></code></pre></div>
<p><strong>Before we get into the good stuff, the development team has a
small request</strong>. If you use <code>rmacrostrat</code> in your
research, please cite the associated publication. This will help us to
continue our work in supporting you to do yours. You can access the
appropriate citation via:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/citation.html" class="external-link">citation</a></span><span class="op">(</span><span class="st">"rmacrostrat"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## To cite rmacrostrat in publications, use the following citation:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Jones, L.A., Dean, C.D., Gearty, W., and Allen, B.J. 2024. rmacrostrat: An R package for accessing and retrieving</span></span>
<span><span class="co">##   data from the Macrostrat geological database. EarthArXiv, 1–29, doi: 10.31223/X5XX37</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## A BibTeX entry for LaTeX users is</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   @Article{,</span></span>
<span><span class="co">##     title = {rmacrostrat: An R Package for fetching geologic data from the Macrostrat database.},</span></span>
<span><span class="co">##     author = {Lewis A. Jones and Christopher D. Dean and William Gearty and Bethany J. Allen},</span></span>
<span><span class="co">##     year = {2024},</span></span>
<span><span class="co">##     journal = {EarthArXiv},</span></span>
<span><span class="co">##     pages = {1–29},</span></span>
<span><span class="co">##     doi = {10.31223/X5XX37},</span></span>
<span><span class="co">##   }</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="context">Context<a class="anchor" aria-label="anchor" href="#context"></a>
</h2>
<p>The San Juan Basin is a large structural depression which spans parts
of New Mexico, Colorado, Utah, and Arizona. It is renowned for its oil
and natural gas reserves, but it is also well-known for its late
Cretaceous dinosaurs. In this vignette, we will investigate the geologic
attributes of the rocks of the San Juan Basin and use this information
to plot a stratigraphic column. In order to do this, we will make use of
the <code>rmacrostrat</code> package to fetch data from the <a href="https://macrostrat.org" class="external-link">Macrostrat</a> database.</p>
</div>
<div class="section level2">
<h2 id="retrieving-data">Retrieving data<a class="anchor" aria-label="anchor" href="#retrieving-data"></a>
</h2>
<p>Our first step is to search for geologic columns named “San Juan
Basin” and retrieve some basic information about them, using the
<code>def_columns</code> function:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get column definitions for the San Juan Basin</span></span>
<span><span class="fu"><a href="../reference/def_columns.html">def_columns</a></span><span class="op">(</span>column_name <span class="op">=</span> <span class="st">"San Juan Basin"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   col_id col_group_id       col_name    lat      lng col_area max_thick ref_id status t_units project_id notes</span></span>
<span><span class="co">## 1    489            3 San Juan Basin 35.896 -108.068 35096.52      8040      1 active      47          1    NA</span></span></code></pre>
<p>From this call, we can see there is a single column named “San Juan
Basin”. We are also given some information about this column, such as
its geographic location (in the form of a latitude and longitude), the
area over which it spans in km<sup>2</sup>, its thickness in meters, and
the number of geologic units it contains (<code>t_units</code>). We are
also given its <code>col_id</code>, 489, which we can use to retrieve
more information through other functions in <code>rmacrostrat</code>. We
will do this now, specifically using <code>get_columns</code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using the column ID, retrieve the San Juan Basin column</span></span>
<span><span class="va">san_juan</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_columns.html">get_columns</a></span><span class="op">(</span>column_id <span class="op">=</span> <span class="fl">489</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="exploring-data">Exploring data<a class="anchor" aria-label="anchor" href="#exploring-data"></a>
</h2>
<p>We now have much more information relating to the San Juan Basin
column. For example, we can look at the age range it spans:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Print (numerical) age range of San Juan Basin column</span></span>
<span><span class="va">san_juan</span><span class="op">$</span><span class="va">b_age</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2050</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">san_juan</span><span class="op">$</span><span class="va">t_age</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 32.38</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Print (interval) age range of the San Juan Basin column</span></span>
<span><span class="va">san_juan</span><span class="op">$</span><span class="va">b_int_name</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Orosirian"</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">san_juan</span><span class="op">$</span><span class="va">t_int_name</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Rupelian"</span></span></code></pre>
<p>We can see that our column spans from 2050 to 32 million years ago,
from the Orosirian (Paleoproterozoic) to the Rupelian (Cenozoic). Let’s
take a look at the mix of lithologies contained in the column:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Print the lithologies contained in the San Juan Basin column</span></span>
<span><span class="va">san_juan</span><span class="op">$</span><span class="va">lith</span></span></code></pre></div>
<pre><code><span><span class="co">## [[1]]</span></span>
<span><span class="co">##              name            type       class   prop lith_id</span></span>
<span><span class="co">## 1       claystone   siliciclastic sedimentary 0.0015       6</span></span>
<span><span class="co">## 2           shale   siliciclastic sedimentary 0.2867       8</span></span>
<span><span class="co">## 3       siltstone   siliciclastic sedimentary 0.0340       9</span></span>
<span><span class="co">## 4       sandstone   siliciclastic sedimentary 0.2773      10</span></span>
<span><span class="co">## 5          arkose   siliciclastic sedimentary 0.0177      11</span></span>
<span><span class="co">## 6    conglomerate   siliciclastic sedimentary 0.0606      14</span></span>
<span><span class="co">## 7       limestone       carbonate sedimentary 0.0771      30</span></span>
<span><span class="co">## 8        dolomite       carbonate sedimentary 0.0832      31</span></span>
<span><span class="co">## 9       evaporite       evaporite sedimentary 0.0019      34</span></span>
<span><span class="co">## 10         gypsum       evaporite sedimentary 0.0030      36</span></span>
<span><span class="co">## 11      anhydrite       evaporite sedimentary 0.0030      37</span></span>
<span><span class="co">## 12           coal         organic sedimentary 0.0039      38</span></span>
<span><span class="co">## 13        granite        plutonic     igneous 0.0177      53</span></span>
<span><span class="co">## 14         gneiss     metamorphic metamorphic 0.0106      79</span></span>
<span><span class="co">## 15          slate metasedimentary metamorphic 0.0071      82</span></span>
<span><span class="co">## 16       phyllite metasedimentary metamorphic 0.0071      83</span></span>
<span><span class="co">## 17      quartzite metasedimentary metamorphic 0.0147      85</span></span>
<span><span class="co">## 18           clay   siliciclastic sedimentary 0.0030      93</span></span>
<span><span class="co">## 19      graywacke   siliciclastic sedimentary 0.0213     113</span></span>
<span><span class="co">## 20        arenite   siliciclastic sedimentary 0.0097     134</span></span>
<span><span class="co">## 21   syenogranite        plutonic     igneous 0.0035     145</span></span>
<span><span class="co">## 22 quartz arenite   siliciclastic sedimentary 0.0213     169</span></span>
<span><span class="co">## 23   metavolcanic     metaigneous metamorphic 0.0106     178</span></span>
<span><span class="co">## 24          wacke   siliciclastic sedimentary 0.0019     187</span></span>
<span><span class="co">## 25    litharenite   siliciclastic sedimentary 0.0213     198</span></span></code></pre>
<p>So our column contains a total of 25 different lithologies, including
sedimentary, metamorphic, and igneous rocks. We can quickly visualize
the proportion of the column made up of these different rocks, colored
by their class:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract lithologies</span></span>
<span><span class="va">lith_table</span> <span class="op">&lt;-</span> <span class="va">san_juan</span><span class="op">$</span><span class="va">lith</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co"># Plot lithologies by proportion in San Juan Basin column</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">lith_table</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">prop</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></span><span class="op">(</span><span class="va">name</span>, <span class="op">-</span><span class="va">prop</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Plot bars</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Label axes</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span><span class="st">"Lithology"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span><span class="st">"Proportion of stratigraphic column"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="lith_plot-1.png" alt="plot of chunk lith_plot" width="100%"><p class="caption">
plot of chunk lith_plot
</p>
</div>
<p>It seems the San Juan Basin is dominated by sedimentary rocks.
Perhaps this is not surprising given that we know it is famed for
fossils and energy resources! Speaking of these, let’s take a look at
the column’s economic attributes:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Print a summary of economic attributes of the San Juan Basin column</span></span>
<span><span class="va">san_juan</span><span class="op">$</span><span class="va">econ</span></span></code></pre></div>
<pre><code><span><span class="co">## [[1]]</span></span>
<span><span class="co">##            name        type  class   prop econ_id</span></span>
<span><span class="co">## 1 oil reservoir hydrocarbon energy 0.0345       4</span></span>
<span><span class="co">## 2 gas reservoir hydrocarbon energy 0.0345       5</span></span>
<span><span class="co">## 3    gas indet. hydrocarbon energy 0.4138       8</span></span>
<span><span class="co">## 4    oil indet. hydrocarbon energy 0.3103       9</span></span>
<span><span class="co">## 5   uranium ore     nuclear energy 0.1034      10</span></span>
<span><span class="co">## 6          coal        coal energy 0.0690      13</span></span>
<span><span class="co">## 7       aquifer     aquifer  water 0.0345      17</span></span></code></pre>
<p>Here we can see that not only does the San Juan Basin contain coal,
oil, and natural gas, but it also has some uranium ore and aquifers. We
can also see the number of <a href="https://paleobiodb.org" class="external-link">Paleobiology
Database</a> collections linked to the San Juan Basin in our column
information:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Print number of PBDB collections</span></span>
<span><span class="va">san_juan</span><span class="op">$</span><span class="va">pbdb_collections</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 646</span></span></code></pre>
<p>To view more information about these fossil data, we need to use a
different <code>rmacrostrat</code> function,
<code>get_fossils</code>:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Retrieve fossils associated with the San Juan Basin column</span></span>
<span><span class="va">sj_fossils</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_fossils.html">get_fossils</a></span><span class="op">(</span>column_id <span class="op">=</span> <span class="fl">489</span><span class="op">)</span></span></code></pre></div>
<p>This table contains information about each of the ~650 <a href="https://paleobiodb.org" class="external-link">Paleobiology Database</a> collections
associated with the San Juan Basin, including their ages and the number
of occurrences they contain. Let’s find out how many fossil occurrences
we have in total:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># How many fossil occurrences are associated with the San Juan Basin?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sj_fossils</span><span class="op">$</span><span class="va">pbdb_occs</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2151</span></span></code></pre>
<p>So over 2000 fossils are known from this single basin. We can also
visualize the temporal distribution of these fossil collections, using
the midpoint of their age ranges:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add midpoint age for plotting</span></span>
<span><span class="va">sj_fossils</span><span class="op">$</span><span class="va">m_age</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">sj_fossils</span><span class="op">$</span><span class="va">b_age</span> <span class="op">+</span> <span class="va">sj_fossils</span><span class="op">$</span><span class="va">t_age</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span>
<span></span>
<span><span class="co"># Plot of fossil occurrence counts from the San Juan Basin through time</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sj_fossils</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">m_age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="co"># Histogram with bars 5 million years wide</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">5</span>, boundary <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Label y-axis</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span><span class="st">"Number of fossil collections"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Label x-axis and reverse direction</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_reverse</a></span><span class="op">(</span><span class="st">"Time (Ma)"</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">250</span>, <span class="fl">200</span>, <span class="fl">150</span>, <span class="fl">100</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Theming </span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add geological timescale</span></span>
<span>  <span class="fu"><a href="https://williamgearty.com/deeptime/reference/coord_geo.html" class="external-link">coord_geo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="fossil_plot-1.png" alt="plot of chunk fossil_plot" width="100%"><p class="caption">
plot of chunk fossil_plot
</p>
</div>
<p>From this plot, we can see that the San Juan Basin fossils range in
age from the Permian to the Paleogene, but we have the highest
concentration of fossil collections around the K-Pg boundary. Now that
we have explored the data in the <a href="https://macrostrat.org" class="external-link">Macrostrat</a> database on the San Juan
Basin, it is time to plot our stratigraphic column.</p>
</div>
<div class="section level2">
<h2 id="plotting-the-stratigraphic-column">Plotting the stratigraphic column<a class="anchor" aria-label="anchor" href="#plotting-the-stratigraphic-column"></a>
</h2>
<p>To plot the stratigraphic column, we will need to obtain data for
each lithological unit contained within the San Juan Basin column. We
will do this using another <code>rmacrostrat</code> function,
<code>get_units</code>, and referencing the <code>column_id</code> for
the San Juan Basin. To keep our column plot contained, we will limit it
to geological units which are Cretaceous in age:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using the column ID, retrieve the units in the San Juan Basin column</span></span>
<span><span class="va">san_juan_units</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_units.html">get_units</a></span><span class="op">(</span>column_id <span class="op">=</span> <span class="fl">489</span>, interval_name <span class="op">=</span> <span class="st">"Cretaceous"</span><span class="op">)</span></span>
<span><span class="co"># See the column names and number of rows</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">san_juan_units</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "unit_id"          "section_id"       "col_id"           "project_id"       "col_area"         "unit_name"       </span></span>
<span><span class="co">##  [7] "strat_name_id"    "Mbr"              "Fm"               "Gp"               "SGp"              "t_age"           </span></span>
<span><span class="co">## [13] "b_age"            "max_thick"        "min_thick"        "outcrop"          "pbdb_collections" "pbdb_occurrences"</span></span>
<span><span class="co">## [19] "lith"             "environ"          "econ"             "measure"          "notes"            "color"           </span></span>
<span><span class="co">## [25] "text_color"       "t_int_id"         "t_int_name"       "t_int_age"        "t_prop"           "units_above"     </span></span>
<span><span class="co">## [31] "b_int_id"         "b_int_name"       "b_int_age"        "b_prop"           "units_below"      "strat_name_long" </span></span>
<span><span class="co">## [37] "refs"             "clat"             "clng"             "t_plat"           "t_plng"           "b_plat"          </span></span>
<span><span class="co">## [43] "b_plng"</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">san_juan_units</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 17</span></span></code></pre>
<p>We now have information for each of the 17 Cretaceous geologic units
contained within the San Juan Basin, including the age of the top and
bottom of each, which is what we will use to plot our stratigraphic
column. To reiterate, the y-axis on our plot is going to be time rather
than height or thickness, so any unconformities present in the column
will be evident. We can start out very simply, by using
<code>geom_rect</code> in <code>ggplot2</code> to plot a rectangle
corresponding to the age range of each unit in the section.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot stratigraphic column</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">san_juan_units</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">b_age</span>, ymax <span class="op">=</span> <span class="va">t_age</span>, xmin <span class="op">=</span> <span class="fl">0</span>, xmax <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Plot units</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_rect</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Reverse direction of y-axis</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">145</span>, <span class="fl">66</span><span class="op">)</span>, n.breaks <span class="op">=</span> <span class="fl">10</span>, name <span class="op">=</span> <span class="st">"Time (Ma)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Theming</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>        axis.line.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.ticks.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="column_a-1.png" alt="plot of chunk column_a" width="100%"><p class="caption">
plot of chunk column_a
</p>
</div>
<p>We can already see something that roughly resembles a stratigraphic
column. One thing to notice here is that we seem to have some overlap
between our units, resulting in a darker shade of gray. We can take a
closer look at this by dodging the units horizontally.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot stratigraphic column</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">san_juan_units</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">b_age</span>, ymax <span class="op">=</span> <span class="va">t_age</span>, xmin <span class="op">=</span> <span class="fl">0</span>, xmax <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Plot units with position dodge</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_rect</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge2"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Reverse direction of y-axis</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">145</span>, <span class="fl">66</span><span class="op">)</span>, n.breaks <span class="op">=</span> <span class="fl">10</span>, name <span class="op">=</span> <span class="st">"Time (Ma)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Theming</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>        axis.line.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.ticks.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="column_b-1.png" alt="plot of chunk column_b" width="100%"><p class="caption">
plot of chunk column_b
</p>
</div>
<p>Indeed, there are two units that overlap with each other: the Gallup
Sandstone and the Upper Shale Member of the Mancos Shale. We can make
these units plot next to each other by adding columns to our dataframe
which define the x-axis values.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Specify x_min and x_max in dataframe</span></span>
<span><span class="va">san_juan_units</span><span class="op">$</span><span class="va">x_min</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">san_juan_units</span><span class="op">$</span><span class="va">x_max</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="co"># Tweak values for overlapping units</span></span>
<span><span class="va">san_juan_units</span><span class="op">$</span><span class="va">x_max</span><span class="op">[</span><span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">san_juan_units</span><span class="op">$</span><span class="va">x_min</span><span class="op">[</span><span class="fl">11</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span></span>
<span><span class="co"># Plot stratigraphic column</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">san_juan_units</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">b_age</span>, ymax <span class="op">=</span> <span class="va">t_age</span>,</span>
<span>                           xmin <span class="op">=</span> <span class="va">x_min</span>, xmax <span class="op">=</span> <span class="va">x_max</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Plot units</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_rect</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Reverse direction of y-axis</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">145</span>, <span class="fl">66</span><span class="op">)</span>, n.breaks <span class="op">=</span> <span class="fl">10</span>, name <span class="op">=</span> <span class="st">"Time (Ma)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Theming</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>        axis.line.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.ticks.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="column_c-1.png" alt="plot of chunk column_c" width="100%"><p class="caption">
plot of chunk column_c
</p>
</div>
<p>However, there is a lot we can do to improve the aesthetics of our
plot. For example, the column named <code>color</code> in our dataframe
specifies the hexadecimal color corresponding to the dominant lithology
of the unit. We can use this to color-code the units by lithology.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot stratigraphic column</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">san_juan_units</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">b_age</span>, ymax <span class="op">=</span> <span class="va">t_age</span>,</span>
<span>                           xmin <span class="op">=</span> <span class="va">x_min</span>, xmax <span class="op">=</span> <span class="va">x_max</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Plot units, colored by rock type</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">san_juan_units</span><span class="op">$</span><span class="va">color</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Reverse direction of y-axis</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">145</span>, <span class="fl">66</span><span class="op">)</span>, n.breaks <span class="op">=</span> <span class="fl">10</span>, name <span class="op">=</span> <span class="st">"Time (Ma)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Theming</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>        axis.line.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.ticks.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="column_d-1.png" alt="plot of chunk column_d" width="100%"><p class="caption">
plot of chunk column_d
</p>
</div>
<p>Great! Now let’s add labels indicating the names of the different
units.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add midpoint age for plotting</span></span>
<span><span class="va">san_juan_units</span><span class="op">$</span><span class="va">m_age</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">san_juan_units</span><span class="op">$</span><span class="va">b_age</span> <span class="op">+</span> <span class="va">san_juan_units</span><span class="op">$</span><span class="va">t_age</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span>
<span></span>
<span><span class="co"># Plot stratigraphic column</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">san_juan_units</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">b_age</span>, ymax <span class="op">=</span> <span class="va">t_age</span>,</span>
<span>                           xmin <span class="op">=</span> <span class="va">x_min</span>, xmax <span class="op">=</span> <span class="va">x_max</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Plot units, colored by rock type</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">san_juan_units</span><span class="op">$</span><span class="va">color</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add text labels</span></span>
<span>  <span class="fu"><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">geom_text_repel</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x_max</span>, y <span class="op">=</span> <span class="va">m_age</span>, label <span class="op">=</span> <span class="va">unit_name</span><span class="op">)</span>,</span>
<span>                  size <span class="op">=</span> <span class="fl">4</span>, hjust <span class="op">=</span> <span class="fl">0</span>, force <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                  min.segment.length <span class="op">=</span> <span class="fl">0</span>, direction <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>                  nudge_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep_len</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">17</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Reverse direction of y-axis</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">145</span>, <span class="fl">66</span><span class="op">)</span>, n.breaks <span class="op">=</span> <span class="fl">10</span>, name <span class="op">=</span> <span class="st">"Time (Ma)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Theming</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>        axis.line.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.ticks.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="column_e-1.png" alt="plot of chunk column_e" width="100%"><p class="caption">
plot of chunk column_e
</p>
</div>
<p>And finally, we can add a column along the y-axis indicating the
different stages of the Cretaceous, using the R package
<code>deeptime</code>:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot stratigraphic column</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">san_juan_units</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">b_age</span>, ymax <span class="op">=</span> <span class="va">t_age</span>,</span>
<span>                           xmin <span class="op">=</span> <span class="va">x_min</span>, xmax <span class="op">=</span> <span class="va">x_max</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Plot units, colored by rock type</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">san_juan_units</span><span class="op">$</span><span class="va">color</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add text labels</span></span>
<span>  <span class="fu"><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">geom_text_repel</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x_max</span>, y <span class="op">=</span> <span class="va">m_age</span>, label <span class="op">=</span> <span class="va">unit_name</span><span class="op">)</span>,</span>
<span>                  size <span class="op">=</span> <span class="fl">3.5</span>, hjust <span class="op">=</span> <span class="fl">0</span>, force <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                  min.segment.length <span class="op">=</span> <span class="fl">0</span>, direction <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>                  nudge_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep_len</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">17</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Reverse direction of y-axis</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">145</span>, <span class="fl">66</span><span class="op">)</span>, n.breaks <span class="op">=</span> <span class="fl">10</span>, name <span class="op">=</span> <span class="st">"Time (Ma)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Theming</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>        axis.line.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.ticks.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add geological time scale</span></span>
<span>  <span class="fu"><a href="https://williamgearty.com/deeptime/reference/coord_geo.html" class="external-link">coord_geo</a></span><span class="op">(</span>pos <span class="op">=</span> <span class="st">"left"</span>, dat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"stages"</span><span class="op">)</span>, rot <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="column_f-1.png" alt="plot of chunk column_f" width="100%"><p class="caption">
plot of chunk column_f
</p>
</div>
<p>Hopefully this vignette has shown you the potential uses for
<code>rmacrostrat</code> functions and helped provide a workflow for
your own analyses. If you have any questions about the package or its
functionality, please feel free to join our <a href="https://groups.google.com/g/palaeoverse" class="external-link">Palaeoverse Google
group</a> and leave a question; we’ll aim to answer it as soon as
possible!</p>
<p>If you’re interested in learning more about <code>rmacrostrat</code>,
don’t forget to check out our other vignettes! You can see which ones
are available by calling
<code>vignette(package = "rmacrostrat")</code>.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Gearty, W. 2024. deeptime: Plotting Tools for Anyone Working in Deep
Time. R package version 1.1.1, <a href="https://CRAN.R-project.org/package=deeptime" class="external-link uri">https://CRAN.R-project.org/package=deeptime</a>.</p>
<p>Jones, L.A., Gearty, W., Allen, B.J., Eichenseer, K., Dean, C.D.,
Galván S., Kouvari, M., Godoy, P.L., Nicholl, C.S.C., Dillon, E.M.,
Flannery-Sutherland, J.T., Chiarenza, A.A. 2022. palaeoverse: A
community-driven R package to support palaeobiological analysis.
<em>Methods in Ecology and Evolution</em>, 14(9), 2205–2215. doi:
10.1111/2041-210X.14099.</p>
<p>Wickham, H. 2016. ggplot2: Elegant Graphics for Data Analysis.
<em>Springer-Verlag New York</em>.</p>
</div>
</div>
<style type="text/css">
p.caption {
  display: none;
}
</style></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.lewisajones.com" class="external-link">Lewis A. Jones</a>, <a href="https://williamgearty.com" class="external-link">William Gearty</a>, <a href="https://www.researchgate.net/profile/Christopher-Dean-15" class="external-link">Christopher D. Dean</a>, <a href="https://bsse.ethz.ch/cevo/the-group/people/person-detail.html?persid=295484" class="external-link">Bethany Allen</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
