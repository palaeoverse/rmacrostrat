<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Making a geologic outcrop map with rmacrostrat • rmacrostrat</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Making a geologic outcrop map with rmacrostrat">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rmacrostrat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/geologic-map.html">Making a geologic outcrop map with rmacrostrat</a></li>
    <li><a class="dropdown-item" href="../articles/geological-completeness.html">Quantifying the geological completeness of paleontological sampling in North America</a></li>
    <li><a class="dropdown-item" href="../articles/stratigraphic-column.html">Plotting a stratigraphic column with rmacrostrat</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/palaeoverse/rmacrostrat/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Making a geologic outcrop map with rmacrostrat</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/palaeoverse/rmacrostrat/blob/main/vignettes/geologic-map.Rmd" class="external-link"><code>vignettes/geologic-map.Rmd</code></a></small>
      <div class="d-none name"><code>geologic-map.Rmd</code></div>
    </div>

    
    
<p><strong>Authors:</strong> <a href="https://palaeoverse.org/#about-us" class="external-link">The Palaeoverse Development
Team</a></p>
<p><strong>Last updated:</strong> 2024-07-23</p>
<div style="text-align: justify">
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><code>rmacrostrat</code> is an R package that allows users to easily
retrieve geologic data from the <a href="https://macrostrat.org" class="external-link">Macrostrat</a> database and facilitates
analyses of these data within the R environment. This vignette (or
tutorial, if you prefer) is provided to guide you through the
installation process and some of the functionality available within
<code>rmacrostrat</code>. Specifically, we will focus on making a
geographic map of a specific geologic formation, a commonly required
(and very important) figure for a variety of purposes across the
geosciences.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The <code>rmacrostrat</code> package can be installed via CRAN, or
its dedicated <a href="https://github.com/palaeoverse/rmacrostrat" class="external-link">GitHub repository</a>
if the development version is preferred. To install via CRAN, simply
use:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"rmacrostrat"</span><span class="op">)</span></span></code></pre></div>
<p>To install the development version, first install the
<code>devtools</code> package, and then use <code>install_github</code>
to install <code>rmacrostrat</code> directly from GitHub.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"palaeoverse/rmacrostrat"</span><span class="op">)</span></span></code></pre></div>
<p>You can now load <code>rmacrostrat</code> using the standard
<code>library</code> function:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rmacrostrat.palaeoverse.org">rmacrostrat</a></span><span class="op">)</span></span></code></pre></div>
<p><strong>Before we get into the good stuff, the development team has a
small request</strong>. If you use <code>rmacrostrat</code> in your
research, please cite the associated publication. This will help us to
continue our work in supporting you to do yours. You can access the
appropriate citation via:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/citation.html" class="external-link">citation</a></span><span class="op">(</span><span class="st">"rmacrostrat"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## To cite rmacrostrat in publications, use the following citation:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Jones, L.A., Dean, C.D., Gearty, W., and Allen, B.J. 2024.</span></span>
<span><span class="co">##   rmacrostrat: An R package for accessing and retrieving data from the</span></span>
<span><span class="co">##   Macrostrat geological database. TBC TBC TBC</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## A BibTeX entry for LaTeX users is</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   @Article{,</span></span>
<span><span class="co">##     title = {rmacrostrat: An R Package for fetching geologic data from the Macrostrat database.},</span></span>
<span><span class="co">##     author = {Lewis A. Jones and Christopher D. Dean and William Gearty and Bethany J. Allen},</span></span>
<span><span class="co">##     year = {2024},</span></span>
<span><span class="co">##     journal = {TBC},</span></span>
<span><span class="co">##     pages = {TBC},</span></span>
<span><span class="co">##     doi = {TBC},</span></span>
<span><span class="co">##   }</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="context">Context<a class="anchor" aria-label="anchor" href="#context"></a>
</h2>
<p>The Hell Creek is a geologic formation from the late Cretaceous and
early Paleogene of North America, which is found cropping out across
Montana and North and South Dakota, in the United States. It consists of
both freshwater and brackish clays, mudstones, and sandstones, deposited
by a fluvial system on the shoreline of the Western Interior Seaway. The
Hell Creek is famous for its preservation of an extensive array of both
terrestrial and marginal marine fossils from just prior to the K/Pg mass
extinction (66 million years ago), including widely recognizable
dinosaurs such as <em>Edmontosaurus</em>, <em>Triceratops</em> and
<em>Tyrannosaurus rex</em>. In this vignette, we will show you how to
use <code>rmacrostrat</code> to find the outcrop of the Hell Creek
Formation, and use this to create a map which could be used in a
potential publication. Whilst we have chosen a specific formation, this
approach could be applied to any number of geologic units of interest.
So, let’s dive in!</p>
</div>
<div class="section level2">
<h2 id="fetching">Fetching<a class="anchor" aria-label="anchor" href="#fetching"></a>
</h2>
<p>First, we want to find the <code>strat_name_id</code>s that are
associated with the Hell Creek. These IDs are linked to unique
stratigraphic names given to one or more geologic units, such as
Macrostrat units or map units, in the Macrostrat database. We can search
for the relevant IDs by using some of the <code>def_*</code> functions.
These functions provide information about the data stored in the
database. Let’s have a look at the information associated with the name
Hell Creek, using <code><a href="../reference/def_strat_names.html">def_strat_names()</a></code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Search stratigraphic names for Hell Creek</span></span>
<span><span class="fu"><a href="../reference/def_strat_names.html">def_strat_names</a></span><span class="op">(</span>strat_name <span class="op">=</span> <span class="st">"hell creek"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   strat_name      strat_name_long rank strat_name_id concept_id bed bed_id</span></span>
<span><span class="co">## 1 Hell Creek Hell Creek Formation   Fm         71267       8598          0</span></span>
<span><span class="co">## 2 Hell Creek    Hell Creek Member  Mbr         71268       8598          0</span></span>
<span><span class="co">## 3 Hell Creek Hell Creek Formation   Fm           867       8598          0</span></span>
<span><span class="co">##          mbr mbr_id         fm fm_id subgp subgp_id                gp gp_id sgp</span></span>
<span><span class="co">## 1                 0 Hell Creek 71267              0           Montana  2565    </span></span>
<span><span class="co">## 2 Hell Creek  71268      Lance  1090              0 Black Buttes coal 69391    </span></span>
<span><span class="co">## 3                 0 Hell Creek   867              0                       0    </span></span>
<span><span class="co">##   sgp_id b_age t_age   b_period  t_period c_interval t_units ref_id</span></span>
<span><span class="co">## 1      0 100.5    56 Cretaceous Paleogene                  0     19</span></span>
<span><span class="co">## 2      0 100.5    56 Cretaceous Paleogene                  0     19</span></span>
<span><span class="co">## 3      0  72.1    66 Cretaceous Paleogene                 13      1</span></span></code></pre>
<p>We can see that there are three different <code>strat_name</code>s
associated with the name Hell Creek. You’ll also see that all three have
the same <code>concept_id</code>, showing that these stratigraphic names
are united under a single geologic entity. We can therefore use this
<code>concept_id</code> to search for all references to the Hell
Creek:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Search stratigraphic names for all associated with Hell Creek concept_id</span></span>
<span><span class="va">hc_def</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/def_strat_names.html">def_strat_names</a></span><span class="op">(</span>concept_id <span class="op">=</span> <span class="fl">8598</span><span class="op">)</span></span>
<span><span class="co"># View data</span></span>
<span><span class="va">hc_def</span></span></code></pre></div>
<pre><code><span><span class="co">##   strat_name      strat_name_long rank strat_name_id concept_id bed bed_id</span></span>
<span><span class="co">## 1 Hell Creek Hell Creek Formation   Fm         71267       8598          0</span></span>
<span><span class="co">## 2 Hell Creek    Hell Creek Member  Mbr         71268       8598          0</span></span>
<span><span class="co">## 3 Hell Creek Hell Creek Formation   Fm           867       8598          0</span></span>
<span><span class="co">##          mbr mbr_id         fm fm_id subgp subgp_id                gp gp_id sgp</span></span>
<span><span class="co">## 1                 0 Hell Creek 71267              0           Montana  2565    </span></span>
<span><span class="co">## 2 Hell Creek  71268      Lance  1090              0 Black Buttes coal 69391    </span></span>
<span><span class="co">## 3                 0 Hell Creek   867              0                       0    </span></span>
<span><span class="co">##   sgp_id b_age t_age   b_period  t_period c_interval t_units ref_id</span></span>
<span><span class="co">## 1      0 100.5    56 Cretaceous Paleogene                  0     19</span></span>
<span><span class="co">## 2      0 100.5    56 Cretaceous Paleogene                  0     19</span></span>
<span><span class="co">## 3      0  72.1    66 Cretaceous Paleogene                 13      1</span></span></code></pre>
<p>Yup, these three are the only entries for Hell Creek. But hang on!
Before going ahead and using these to pull our spatial data, you’ll also
notice that one of the <code>strat_name</code>s here is actually the
Hell Creek “Member”, which is described as belonging to the Lance
Formation. On a hunt in the literature, it turns out that this is a term
used for the Hell Creek before it was designated to the rank of
formation (Archibald, 1982), so it’s okay to include here. But it’s
always worth remembering to check your data for errors prior to using
it!</p>
<p>Let’s go ahead and use the <code>strat_name_id</code>s associated
with the Hell Creek <code>concept_id</code> to get some spatial data. To
do this, we’ll need to use the <code><a href="../reference/get_map_outcrop.html">get_map_outcrop()</a></code> function,
which allows us to grab outcrop polygons from geologic maps. Let’s do
that now, specifying that we want the output to be returned as an sf, or
‘simple features’, object. An sf object is a collection of simple
features (representations of real world objects) that includes
attributes and geometries in the form of a <code>data.frame</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get spatial outcrop information associated with each Hell Creek strat_name_id</span></span>
<span><span class="va">hc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_map_outcrop.html">get_map_outcrop</a></span><span class="op">(</span>strat_name_id <span class="op">=</span> <span class="va">hc_def</span><span class="op">$</span><span class="va">strat_name_id</span>, sf <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Nice. Let’s have a look at the first entry to see what the data looks
like.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Look at the first entry</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">hc</span>, n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Simple feature collection with 1 feature and 20 fields</span></span>
<span><span class="co">## Geometry type: MULTIPOLYGON</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: -110.0199 ymin: 45.86057 xmax: -110.0168 ymax: 45.86277</span></span>
<span><span class="co">## Geodetic CRS:  WGS 84</span></span>
<span><span class="co">##    map_id source_id                 name           strat_name</span></span>
<span><span class="co">## 1 2092425        25 Hell Creek Formation Hell Creek Formation</span></span>
<span><span class="co">##                            lith descrip comments macro_units       strat_names</span></span>
<span><span class="co">## 1 Major:: {sandstone, mudstone}                         9213 867, 71267, 71268</span></span>
<span><span class="co">##   liths t_int_id t_int_age      t_int_name b_int_id b_int_age      b_int_name</span></span>
<span><span class="co">## 1 7, 10       34        66 Late Cretaceous       34     100.5 Late Cretaceous</span></span>
<span><span class="co">##     color t_age b_age best_int_name                       geometry</span></span>
<span><span class="co">## 1 #F2FA8C    66  72.1 Maastrichtian MULTIPOLYGON (((-110.0168 4...</span></span></code></pre>
<p>That looks like what we need! We have a simple features collection
consisting of multi-polygons, with attributes that indicate it contains
data for the Hell Creek Formation. Now let’s move on to visualizing the
data.</p>
</div>
<div class="section level2">
<h2 id="visualization">Visualization<a class="anchor" aria-label="anchor" href="#visualization"></a>
</h2>
<p>To plot our outcrop map, we’ll have to install and load some packages
that let us handle and plot spatial data. Let’s do that now.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install rnaturalearthhires to use maps with state boundaries</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"ropensci/rnaturalearthhires"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="color: #00BBBB;">R CMD build</span> <span style="color: #00BBBB;">─────────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">## * checking for file ‘/tmp/RtmpfSPi1y/remotes1f4b6ba8bccc/ropensci-rnaturalearthhires-dd1e210/DESCRIPTION’ ... OK</span></span>
<span><span class="co">## * preparing ‘rnaturalearthhires’:</span></span>
<span><span class="co">## * checking DESCRIPTION meta-information ... OK</span></span>
<span><span class="co">## * checking for LF line-endings in source and make files and shell scripts</span></span>
<span><span class="co">## * checking for empty or unneeded directories</span></span>
<span><span class="co">## * building ‘rnaturalearthhires_1.0.0.9000.tar.gz’</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load required packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/rnaturalearth/" class="external-link">rnaturalearth</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/rnaturalearthhires" class="external-link">rnaturalearthhires</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span></code></pre></div>
<p>First, we can use the packages <code>rnaturalearth</code> and
<code>rnaturalearthhires</code> to get the maps and state/province
outlines of the USA, Mexico and Canada to use as a background.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load country outlines</span></span>
<span><span class="va">us</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/rnaturalearth/reference/ne_states.html" class="external-link">ne_states</a></span><span class="op">(</span>country <span class="op">=</span> <span class="st">"united states of america"</span>, returnclass <span class="op">=</span> <span class="st">"sf"</span><span class="op">)</span></span>
<span><span class="va">ca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/rnaturalearth/reference/ne_states.html" class="external-link">ne_states</a></span><span class="op">(</span>country <span class="op">=</span> <span class="st">"canada"</span>, returnclass <span class="op">=</span> <span class="st">"sf"</span><span class="op">)</span></span>
<span><span class="va">mx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/rnaturalearth/reference/ne_states.html" class="external-link">ne_states</a></span><span class="op">(</span>country <span class="op">=</span> <span class="st">"mexico"</span>, returnclass <span class="op">=</span> <span class="st">"sf"</span><span class="op">)</span></span></code></pre></div>
<p>Now we’re ready to plot our outcrop! We can use the
<code>ggplot2</code> package to help us do this, in particular the
<code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf()</a></code> function. Let’s plot our background maps and
outcrop now:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot USA, Canada, and Hell Creek outcrop</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">us</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ca</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">hc</span>, color <span class="op">=</span> <span class="cn">NA</span>, fill <span class="op">=</span> <span class="st">"#C7622B"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">112</span>, <span class="op">-</span><span class="fl">97</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">44</span>, <span class="fl">50</span><span class="op">)</span>, expand <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Longitude (º)"</span>, y <span class="op">=</span> <span class="st">"Latitude (º)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot-outcrop-1.png" width="100%"></p>
<p>Looking good! But we can take this map a bit further. A common
dinosaur found in the Hell Creek is <em>Edmontosaurus</em>, a large
duck-billed dinosaur. Let’s combine what we’ve got so far with data from
<a href="https://paleobiodb.org" class="external-link">The Paleobiology Database</a> (PBDB) to
make a map of <em>Edmontosaurus</em> occurrences in the Hell Creek.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Access PBDB API for Edmontosaurus occurrences from the Hell Creek</span></span>
<span><span class="va">ed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"https://paleobiodb.org/data1.2/occs/list.csv"</span>,</span>
<span>                      <span class="st">"?base_name=Edmontosaurus&amp;strat=Hell%20Creek&amp;show=full"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Turn points into spatial features</span></span>
<span><span class="va">ed_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ed</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lng"</span>, <span class="st">"lat"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Set coordinate system (WGS84) for Edmontosaurus occurrences</span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">ed_sf</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="fl">4326</span><span class="op">)</span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">us</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ca</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">hc</span>, color <span class="op">=</span> <span class="cn">NA</span>, fill <span class="op">=</span> <span class="st">"#C7622B"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ed_sf</span>, color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">112</span>, <span class="op">-</span><span class="fl">97</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">44</span>, <span class="fl">50</span><span class="op">)</span>, expand <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Longitude (º)"</span>, y <span class="op">=</span> <span class="st">"Latitude (º)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot-Edmontosaurus-1.png" width="100%"></p>
<p>Those <em>Edmontosaurus</em> occurrences are now plotted on the map.
You may notice that there are some occurrences that don’t overlay the
plotted outcrop, despite apparently being from the Hell Creek. This
could be due to an error in the PBDB data, potentially relating to the
accuracy of the latitude and longitude co-ordinates, or it could be that
we’re missing some outcrop data of the Hell Creek. Either way, this
shows that plotting occurrences over their respective outcrop can a good
way to explore potential data issues.</p>
<p>Aside from those errant occurrences, it’s starting to look pretty
good! But we can add a few more finishing touches to really make it pop.
First, let’s the use package <a href="https://rphylopic.palaeoverse.org/index.html" class="external-link"><code>rphylopic</code></a>
to add a silhouette of <em>Edmontosaurus</em> to the map.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the rphylopic package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rphylopic.palaeoverse.org" class="external-link">rphylopic</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get an appropriate silhouette for Edmontosaurus</span></span>
<span><span class="va">ed_uuid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rphylopic.palaeoverse.org/reference/get_uuid.html" class="external-link">get_uuid</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Edmontosaurus"</span>, n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="co"># Get the attribution information for the author of the image</span></span>
<span><span class="fu"><a href="https://rphylopic.palaeoverse.org/reference/get_attribution.html" class="external-link">get_attribution</a></span><span class="op">(</span>uuid <span class="op">=</span> <span class="va">ed_uuid</span>, text <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Organism silhouettes are from PhyloPic (https://www.phylopic.org/; T. Michael Keesey, 2023) and were added using the rphylopic R package ver. 1.4.0 (Gearty &amp; Jones, 2023). Silhouette was made by Matt Dempsey, 2020 (CC BY 3.0). Silhouette was contributed by Matthew Dempsey.</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Setup data.frame for the silhouette (plot location)</span></span>
<span><span class="va">silhouette_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">-</span><span class="fl">99</span>, y <span class="op">=</span> <span class="fl">49.5</span>, name <span class="op">=</span> <span class="st">"Edmontosaurus"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the map</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">us</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ca</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">hc</span>, color <span class="op">=</span> <span class="cn">NA</span>, fill <span class="op">=</span> <span class="st">"#C7622B"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ed_sf</span>, color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">112</span>, <span class="op">-</span><span class="fl">97</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">44</span>, <span class="fl">50</span><span class="op">)</span>, expand <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rphylopic.palaeoverse.org/reference/geom_phylopic.html" class="external-link">geom_phylopic</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">silhouette_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, uuid <span class="op">=</span> <span class="va">ed_uuid</span>, </span>
<span>                size <span class="op">=</span> <span class="fl">0.8</span>, alpha <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Longitude (º)"</span>, y <span class="op">=</span> <span class="st">"Latitude (º)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="add-rphylopic-1.png" width="100%"></p>
<p>Nice! Finally, we can add a few other touches to make it a
publication-worthy figure, including an inlay map, a scale bar, and a
North arrow:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load `ggpatial` package to add annotations, and `cowplot` to stitch final map </span></span>
<span><span class="co"># together</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://paleolimbot.github.io/ggspatial/" class="external-link">ggspatial</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span></span>
<span><span class="co"># Make an inlay using the country maps we included earlier</span></span>
<span><span class="va">inset</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">us</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ca</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mx</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"rect"</span>, xmin <span class="op">=</span> <span class="op">-</span><span class="fl">112</span>, xmax <span class="op">=</span> <span class="op">-</span><span class="fl">97</span>, ymin <span class="op">=</span> <span class="fl">44</span>, ymax <span class="op">=</span> <span class="fl">50</span>, </span>
<span>            color <span class="op">=</span> <span class="st">"red"</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">130</span>, <span class="op">-</span><span class="fl">70</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">70</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_test</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.ticks.length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0</span>, <span class="st">"pt"</span><span class="op">)</span>,</span>
<span>        axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>        panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightblue"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Add a scale bar, North arrow, and new theme to the original map and save it</span></span>
<span><span class="va">ed_hc_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">us</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ca</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">hc</span>,</span>
<span>          color <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>          fill <span class="op">=</span> <span class="st">"#C7622B"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ed_sf</span>, </span>
<span>          color <span class="op">=</span> <span class="st">"black"</span>, </span>
<span>          size <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">112</span>, <span class="op">-</span><span class="fl">97</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">44</span>, <span class="fl">50</span><span class="op">)</span>, expand <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/annotation_north_arrow.html" class="external-link">annotation_north_arrow</a></span><span class="op">(</span>location <span class="op">=</span> <span class="st">"br"</span>,</span>
<span>                         pad_y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.75</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>                         height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"cm"</span><span class="op">)</span>, width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/annotation_scale.html" class="external-link">annotation_scale</a></span><span class="op">(</span>location <span class="op">=</span> <span class="st">"br"</span>, width_hint <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rphylopic.palaeoverse.org/reference/geom_phylopic.html" class="external-link">geom_phylopic</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">silhouette_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, uuid <span class="op">=</span> <span class="va">ed_uuid</span>, </span>
<span>              size <span class="op">=</span> <span class="fl">0.8</span>, alpha <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Longitude (º)"</span>, y <span class="op">=</span> <span class="st">"Latitude (º)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># Plot the two together</span></span>
<span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/ggdraw.html" class="external-link">ggdraw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://wilkelab.org/cowplot/reference/draw_plot.html" class="external-link">draw_plot</a></span><span class="op">(</span><span class="va">ed_hc_map</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://wilkelab.org/cowplot/reference/draw_plot.html" class="external-link">draw_plot</a></span><span class="op">(</span><span class="va">inset</span>, <span class="fl">0.08</span>, <span class="fl">0.63</span>, width <span class="op">=</span> <span class="fl">0.2</span>, height <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></code></pre></div>
<p><img src="add-inlay-scale-1.png" width="100%"></p>
<p>And that’s it! One completed map.</p>
<p>…But that’s not all we can do with outcrop data! As a quick extra,
let’s calculate the total outcrop area of the Hell Creek Formation:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fix potential issues with polygon boundaries/shapes</span></span>
<span><span class="va">hc_area</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/valid.html" class="external-link">st_make_valid</a></span><span class="op">(</span><span class="va">hc</span><span class="op">)</span></span>
<span><span class="co"># Calculate the area in meters squared</span></span>
<span><span class="va">area_m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_measures.html" class="external-link">st_area</a></span><span class="op">(</span><span class="va">hc_area</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Convert the area to kilometers squared</span></span>
<span><span class="va">area_km</span> <span class="op">&lt;-</span> <span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="va">area_m</span>, <span class="va">km</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">area_km</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 37564.86 [km^2]</span></span></code></pre>
<p>So from these few lines of code, we can work out that the total
outcrop area for the Hell Creek Formation is a touch larger than the
total land area of Polynesia (which is approximately 37,141
km<sup>2</sup>)! Pretty neat.</p>
<p>Hopefully this vignette has shown you some potential uses for
<code>rmacrostrat</code> functions and helped provide a workflow for
your own analyses. If you have any questions about the package or its
functionality, please feel free to join our <a href="https://groups.google.com/g/palaeoverse" class="external-link">Palaeoverse Google
group</a> and leave a comment; we’ll aim to answer it as soon as
possible!</p>
<p>If you’re interested in learning more about <code>rmacrostrat</code>,
don’t forget to check out our other vignettes! You can see which ones
are available by calling
<code>vignette(package = "rmacrostrat")</code>.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Archibald, J.D. (1982). A study of Mammalia and geology across the
Cretaceous-Tertiary boundary in Garfield County, Montana (Vol. 122).
Univ of California Press.</p>
<p>Dunnington, D. (2023). <em>ggspatial: Spatial Data Framework for
ggplot2</em>. R package version 1.1.9, <a href="https://CRAN.R-project.org/package=ggspatial" class="external-link uri">https://CRAN.R-project.org/package=ggspatial</a>.</p>
<p>Gearty, W., and Jones, L.A., 2023, rphylopic: An R package for
fetching, transforming, and visualising PhyloPic silhouettes: Methods in
Ecology and Evolution, v. 14, p. 2700–2708, doi: <a href="https://doi.org/10.1111/2041-210X.14221" class="external-link">10.1111/2041-210X.14221</a>.</p>
<p>Massicotte, P., South, A. (2023). <em>rnaturalearth: World Map Data
from Natural Earth</em>. R package version 1.0.1, <a href="https://CRAN.R-project.org/package=rnaturalearth" class="external-link uri">https://CRAN.R-project.org/package=rnaturalearth</a>.</p>
<p>Pebesma, E., &amp; Bivand, R. (2023). Spatial Data Science: With
Applications in R. Chapman and Hall/CRC, doi: 10.1201/9780429459016.</p>
<p>Pebesma, E., 2018. Simple Features for R: Standardized Support for
Spatial Vector Data. The R Journal 10 (1), 439-446, doi: <a href="https://doi.org/10.32614/RJ-2018-009" class="external-link">10.32614/RJ-2018-009</a>.</p>
<p>Peters, S.E., Husson, J.M., and Czaplewski, J., 2018, Macrostrat: A
Platform for Geological Data Integration and Deep‐Time Earth Crust
Research: Geochemistry, Geophysics, Geosystems, v. 19, p. 1393–1409,
doi: <a href="https://doi.org/10.1029/2018GC007467" class="external-link">10.1029/2018GC007467</a>.</p>
<p>Uhen, M.D., Allen, B., Behboudi, N., Clapham, M.E., Dunne, E., Hendy,
A., Holroyd, P.A., Hopkins, M., Mannion, P., Novack-Gottshall, P. and
Pimiento, C., 2023. Paleobiology Database User Guide Version 1.0.
<em>PaleoBios</em>, 40(11). doi: <a href="https://doi.org/10.5070/P9401160531" class="external-link">10.5070/P9401160531</a>.</p>
<p>Wickham H. 2016 ggplot2: Elegant Graphics for Data Analysis.
<em>Springer-Verlag New York</em>.</p>
<p>Wickham H., Hester J., Chang W., Bryan J. (2022). <em>devtools: Tools
to Make Developing R Packages Easier</em>. R package version 2.4.5, <a href="https://CRAN.R-project.org/package=devtools" class="external-link uri">https://CRAN.R-project.org/package=devtools</a>.</p>
<p>Wilke C (2024). <em>cowplot: Streamlined Plot Theme and Plot
Annotations for ‘ggplot2’</em>. R package version 1.1.3, <a href="https://CRAN.R-project.org/package=cowplot" class="external-link uri">https://CRAN.R-project.org/package=cowplot</a>.</p>
</div>
</div>
<style type="text/css">
p.caption {
  display: none;
}
</style></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.lewisajones.com" class="external-link">Lewis A. Jones</a>, <a href="https://williamgearty.com" class="external-link">William Gearty</a>, <a href="https://www.researchgate.net/profile/Christopher-Dean-15" class="external-link">Christopher D. Dean</a>, <a href="https://bsse.ethz.ch/cevo/the-group/people/person-detail.html?persid=295484" class="external-link">Bethany Allen</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
